diff --git a/pkgs/tools/networking/ucspi-tcp/compile.patch b/pkgs/tools/networking/ucspi-tcp/compile.patch
new file mode 100644
index 0000000..f2bbb2c
--- /dev/null
+++ b/pkgs/tools/networking/ucspi-tcp/compile.patch
@@ -0,0 +1,13 @@
+diff -ru ucspi-tcp-0.88.orig/Makefile ucspi-tcp-0.88/Makefile
+--- ucspi-tcp-0.88.orig/Makefile	2000-03-18 16:18:42.000000000 +0100
++++ ucspi-tcp-0.88/Makefile	2013-09-30 12:49:28.847991546 +0200
+@@ -328,8 +328,7 @@
+ hasshsgr.h: \
+ choose compile load tryshsgr.c hasshsgr.h1 hasshsgr.h2 chkshsgr \
+ warn-shsgr
+-	./chkshsgr || ( cat warn-shsgr; exit 1 )
+-	./choose clr tryshsgr hasshsgr.h1 hasshsgr.h2 > hasshsgr.h
++	cat hasshsgr.h1 > hasshsgr.h
+ 
+ haswaitp.h: \
+ choose compile load trywaitp.c haswaitp.h1 haswaitp.h2
diff --git a/pkgs/tools/networking/ucspi-tcp/default.nix b/pkgs/tools/networking/ucspi-tcp/default.nix
index 7e1db02..ea18234 100644
--- a/pkgs/tools/networking/ucspi-tcp/default.nix
+++ b/pkgs/tools/networking/ucspi-tcp/default.nix
@@ -23,7 +23,12 @@ in stdenv.mkDerivation rec {
     sha256 = "1kls3xysv3wwmikxychnbfv8vbnb0ih15005hhn4a56pj392r59m";
   };
 
-  patches = ipv6patch;
+  patches = [
+    # Avoid need to have secondary groups for compilation
+    ./compile.patch
+    # IPv6 support
+    ipv6patch
+  ];
 
   buildInputs = [dietlibc];
 
@@ -54,3 +59,5 @@ in stdenv.mkDerivation rec {
     maintainers = with stdenv.lib.maintainers; [ tzeman ];
   };
 }
+
+# vim: et ts=2 sw=2 
